<?xml version="1.0" encoding="UTF-8"?><record_update table="sys_ui_page">
    <sys_ui_page action="INSERT_OR_UPDATE">
        <category>general</category>
        <client_script><![CDATA[//getDrop = document.getElementById('dropdownId').value; 
//process = trim(dropdownId);

function submit() {

    var templateId = gel("doc_template_dropdown").value;
    if (templateId == "") gel('msg').style.display = 'block';

    else {

        var ga = new GlideAjax('x_snc_coe.Audit_Document_Utils');
        ga.addParam('sysparm_name', 'prepareDocument');
        ga.addParam('sysparm_sysId', gel("request").value);
        ga.addParam('sysparm_templateId', templateId);
        ga.getXML(prepDoc);

        function prepDoc(response) {
            var answer = response.responseXML.documentElement.getAttribute("answer");
            GlideDialogWindow.get().destroy(); //Close the dialog window
        }


    }

}]]></client_script>
        <description/>
        <direct>false</direct>
        <endpoint>x_snc_coe_prepare_document.do</endpoint>
        <html><![CDATA[<?xml version="1.0" encoding="utf-8" ?>
<j:jelly trim="false" xmlns:j="jelly:core" xmlns:g="glide" xmlns:j2="null" xmlns:g2="null">
<input type="hidden" name="flag" id="request" value="${sysparm_sysID}"/>
	
	<g:evaluate var="jvar_doc_template" object="true">

		var emt = new GlideRecord('dms_document');
			emt.addEncodedQuery('type=71ba3afa1bdc3c10d1807b46464bcbe1');
			emt.query();
			emt;
  </g:evaluate>
	
  <select id="doc_template_dropdown">

  <option value="">-- None --</option>

  <j:while test="${jvar_doc_template.next()}">

  <option id="opt" value="${jvar_doc_template.getValue('sys_id')}">${jvar_doc_template.getValue('name')}</option>

	</j:while>

</select>
	<span id="msg" style="align:right; color:red; display:none">Please select one Email Template</span>
	<p></p>
	<p>
		<g:dialog_buttons_ok_cancel ok="submit()" ok_type="button" cancel_type="button" />
	</p>
</j:jelly>]]></html>
        <name>prepare_document</name>
        <processing_script/>
        <sys_class_name>sys_ui_page</sys_class_name>
        <sys_created_by>reshmakousar@kpmg.com</sys_created_by>
        <sys_created_on>2021-05-27 08:40:48</sys_created_on>
        <sys_customer_update>false</sys_customer_update>
        <sys_id>cee64eba1b183c10d1807b46464bcb2f</sys_id>
        <sys_mod_count>26</sys_mod_count>
        <sys_name>prepare_document</sys_name>
        <sys_package display_value="Audit CoE" source="x_snc_coe">60a5ae6b1b7850103fa411fc2d4bcbe5</sys_package>
        <sys_policy/>
        <sys_replace_on_upgrade>false</sys_replace_on_upgrade>
        <sys_scope display_value="Audit CoE">60a5ae6b1b7850103fa411fc2d4bcbe5</sys_scope>
        <sys_update_name>sys_ui_page_cee64eba1b183c10d1807b46464bcb2f</sys_update_name>
        <sys_updated_by>reshmakousar@kpmg.com</sys_updated_by>
        <sys_updated_on>2021-06-02 17:06:13</sys_updated_on>
    </sys_ui_page>
</record_update>
